<!DOCTYPE html>
<html lang="zh">
    <head>
        <title>消息服务系统</title>
        <meta name="viewport" content="width=device-width" charset="UTF-8"/>
        <link href="/easyui/themes/icon.css" rel="stylesheet"/>
        <link href="/easyui/themes/bootstrap/easyui.css" rel="stylesheet"/>
        <script src="/easyui/jquery.min.js"></script>
        <script src="/easyui/jquery.easyui.min.js"></script>
        <script src="/easyui/locale/easyui-lang-zh_CN.js"></script>
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <style type="text/css">
            .header {
                font-family: Verdana, Geneva, sans-serif;
                background-color: #2b85e4;
                height: 55px;
                overflow: hidden;
            }

            .header .title {
                letter-spacing: 2px;
                text-shadow: 1px 1px 2px #fff;
                color: #ffffff;
                font-size: 16px;
                height: 30px;
                line-height: 30px;
                padding-left: 10px;
            }

            .footer {
                text-align: center;
                font-size: 11px;
                color: #303030;
                line-height: 40px;
            }

        </style>
    </head>

    <body class="easyui-layout">
        <!-- 顶部导航 -->
        <div class="header" data-options="region:'north',border:false,split:false" style="height:40px; overflow:hidden">
            <div class="title">消息服务系统</div>
        </div>
        <!-- 左边侧菜单 -->
        <div id="menus" class="menus" data-options="region:'west',border:true" style="width: 160px;overflow-x: hidden;"
             title="菜单">
        </div>
        <!-- 底部 -->
        <div class="footer" data-options="region:'south',border:true" style="height:40px;">
            企业级可靠消息服务系统
        </div>
        <!-- 控制台区域 -->
        <div class="center" data-options="region:'center',border:true">
            <div id="tabs" class="easyui-tabs" data-options="fit:true" style="display: inline-block;">
                <div title="首页" data-options="closable:false,iconCls:'icon-standard-application-home'">
                    <iframe src="/page/plan.html"
                            style="width:100%;height:100%;border:none;display: block;user-select: none;position: relative"></iframe>
                </div>
            </div>
        </div>
    </body>
    <script type="text/javascript">

        $(function () {
            let tabs = $("#tabs");
            let menus = $("#menus");

            // 菜单
            menus.sidemenu({
                data: [{
                    text: '同步系统',
                    iconCls: 'icon-standard-application-home',
                    state: 'open',
                    children: [{
                        text: '同步计划列表',
                        iconCls: 'icon-standard-script-code',
                        url: '/page/plan.html'
                    }, {
                        text: '同步记录列表',
                        iconCls: 'icon-standard-page-white-text',
                        url: '/page/result.html'
                    }, {
                        text: '回调记录列表',
                        iconCls: 'icon-standard-arrow-rotate-clockwise',
                        url: '/page/callback.html'
                    }, {
                        text: '同步系统配置',
                        iconCls: 'icon-standard-cog-add',
                        url: '/page/config.html'
                    }
                    ]
                },
                ],
                onSelect: function (item) {
                    if (!tabs.tabs('exists', item.text)) {
                        tabs.tabs('add', {
                            title: item.text,
                            content: `<iframe  src="${item.url}" style="border: none;width:100%;height:100%;display: block;user-select: none"></iframe>`,
                            closable: true,
                            icon: item.iconCls,
                            id: item.id
                        });
                    } else {
                        tabs.tabs('select', item.text);
                    }
                },
                border: false
            });

            // 标签
            tabs.tabs({
                onSelect: function (title, index) {
                    let tab = tabs.tabs('getTab', index);
                    if (menus.hasClass('menus')) {
                        let opts = menus.sidemenu("options");
                        changeMenuSelect(menus, opts, tab[0].id);
                    }
                },
            })
        });

        function changeMenuSelect(menus, opts, selectId) {
            let menutrees = menus.find(".sidemenu-tree");
            menutrees.each(function () {
                let menuItem = $(this);
                changeMenuStyle(menuItem, opts, selectId);
            });

            let tooltips = menus.find(".tooltip-f");
            tooltips.each(function () {
                let menuItem = $(this);
                let tip = menuItem.tooltip("tip");
                if (tip) {
                    tip.find(".sidemenu-tree").each(function () {
                        changeMenuStyle($(this), opts, selectId);
                    });
                    menuItem.tooltip("reposition");
                }
            });
        }

        function changeMenuStyle(menuItem, opts, selectId) {
            menuItem.find("div.tree-node-selected").removeClass("tree-node-selected");
            let node = menuItem.tree("find", selectId);
            if (node) {
                $(node.target).addClass("tree-node-selected");
                opts.selectedItemId = node.id;
                menuItem.trigger("mouseleave.sidemenu");
            }

            changeMenuSelect(menuItem);
        }
    </script>
</html>